<div class="bg-neutral-300 relative w-full h-screen overflow-hidden">
  <div class="px-8">
    <h1 class="text-lg text-gray-700 font-serif font-medium my-8">ゆらぎ記録</h1>

    <div data-controller="mood-selector" class="max-w-2xl mx-auto p-6">
      <%= form_with model: @diary, local: true, class: "diary-mood-form" do |form| %>

        <h3 class="text-xl font-semibold text-center mb-6">今日の気分はいかがですか？</h3>

        <div class="grid grid-cols-3 gap-4 md:grid-cols-5 mb-6">
          <% [
            { value: 1, key: "very_good", color: "text-green-500" },
            { value: 2, key: "good", color: "text-green-400" },
            { value: 3, key: "neutral", color: "text-yellow-500" },
            { value: 4, key: "bad", color: "text-orange-500" },
            { value: 5, key: "very_bad", color: "text-red-500" }
          ].each do |mood| %>
            <label class="mood-option cursor-pointer" data-action="click->mood-selector#select">
              <%= form.radio_button :symptom_level, mood[:value],
                    class: "hidden mood-radio",
                    id: "mood_#{mood[:key]}",
                    data: { mood_selector_target: "radio" } %>

              <div class="mood-icon-wrapper flex flex-col items-center p-4 border-2 border-gray-200 rounded-lg transition-all duration-300 hover:border-blue-400 hover:bg-blue-50 hover:scale-105"
                   data-mood-selector-target="wrapper">

                <!-- パーシャルでアイコンを読み込み -->
                <div class="w-12 h-12 mb-2 <%= mood[:color] %>">
                  <%= render "mood_icons/#{mood[:key]}" %>
                </div>

               <span class="text-xs text-gray-600 text-center">
                  <%= mood[:label] %>
                </span>
              </div>
            </label>
          <% end %>
        </div>

        <!-- 一行日記 -->
        <div class="mt-6">
          <%= form.text_area :oneline_diary,
                placeholder: "今日あったことを一行で...",
                maxlength: 100,
                rows: 3,
                class: "w-full px-3 py-2 border border-gray-300 rounded-md" %>
        </div>

        <!-- 保存ボタン -->
        <div class="mt-6 text-center">
          <%= form.submit "日記を保存",
                class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<style>
  .mood-icon-wrapper.selected {
    border-color: #3b82f6 !important;
    background-color: #dbeafe !important;
    transform: scale(1.05);
  }
</style>
